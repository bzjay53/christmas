# Christmas Trading í…ŒìŠ¤íŠ¸ ì „ëµ ë¬¸ì„œ

## ğŸ“‹ ë¬¸ì„œ ê°œìš”
ì´ ë¬¸ì„œëŠ” Christmas Trading í”„ë¡œì íŠ¸ì˜ í…ŒìŠ¤íŠ¸ ì „ëµ, ìë™í™” í…ŒìŠ¤íŠ¸, í’ˆì§ˆ ë³´ì¦ í”„ë¡œì„¸ìŠ¤ë¥¼ ì •ì˜í•©ë‹ˆë‹¤.

## ğŸ¯ í…ŒìŠ¤íŠ¸ ì „ëµ ê°œìš”

### ğŸ—ï¸ í…ŒìŠ¤íŠ¸ í”¼ë¼ë¯¸ë“œ
```
                    ğŸ”º E2E í…ŒìŠ¤íŠ¸
                   (ëŠë¦¼, ë¹„ìš© ë†’ìŒ)
                  â€¢ ì‚¬ìš©ì ì‹œë‚˜ë¦¬ì˜¤
                 â€¢ ë¸Œë¼ìš°ì € ìë™í™”
                â€¢ ì „ì²´ ì‹œìŠ¤í…œ í†µí•©

              ğŸ”ºğŸ”º í†µí•© í…ŒìŠ¤íŠ¸
             (ì¤‘ê°„ ì†ë„, ì¤‘ê°„ ë¹„ìš©)
            â€¢ API ì—”ë“œí¬ì¸íŠ¸ í…ŒìŠ¤íŠ¸
           â€¢ ë°ì´í„°ë² ì´ìŠ¤ ì—°ë™ í…ŒìŠ¤íŠ¸
          â€¢ ì™¸ë¶€ ì„œë¹„ìŠ¤ ì—°ë™ í…ŒìŠ¤íŠ¸

        ğŸ”ºğŸ”ºğŸ”º ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
       (ë¹ ë¦„, ë¹„ìš© ë‚®ìŒ)
      â€¢ í•¨ìˆ˜/ë©”ì„œë“œ í…ŒìŠ¤íŠ¸
     â€¢ ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸
    â€¢ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ í…ŒìŠ¤íŠ¸
```

### ğŸ“Š í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ ëª©í‘œ
- **ë‹¨ìœ„ í…ŒìŠ¤íŠ¸**: 80% ì´ìƒ
- **í†µí•© í…ŒìŠ¤íŠ¸**: 70% ì´ìƒ
- **E2E í…ŒìŠ¤íŠ¸**: ì£¼ìš” ì‚¬ìš©ì í”Œë¡œìš° 100%
- **ì „ì²´ ì½”ë“œ ì»¤ë²„ë¦¬ì§€**: 75% ì´ìƒ

## ğŸ§ª ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ (Unit Tests)

### ğŸ¨ í”„ë¡ íŠ¸ì—”ë“œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸

#### React ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸
```javascript
// web-dashboard/src/components/__tests__/Dashboard.test.jsx
import React from 'react';
import { render, screen, fireEvent, waitFor } from '@testing-library/react';
import { BrowserRouter } from 'react-router-dom';
import Dashboard from '../Dashboard';
import { AuthProvider } from '../../contexts/AuthContext';

// ëª¨í‚¹
jest.mock('../../lib/supabase', () => ({
  supabase: {
    auth: {
      getUser: jest.fn().mockResolvedValue({
        data: { user: { id: '123', email: 'test@test.com' } }
      })
    }
  }
}));

const renderWithProviders = (component) => {
  return render(
    <BrowserRouter>
      <AuthProvider>
        {component}
      </AuthProvider>
    </BrowserRouter>
  );
};

describe('Dashboard ì»´í¬ë„ŒíŠ¸', () => {
  test('ëŒ€ì‹œë³´ë“œê°€ ì •ìƒì ìœ¼ë¡œ ë Œë”ë§ëœë‹¤', () => {
    renderWithProviders(<Dashboard />);
    
    expect(screen.getByText('Christmas Trading')).toBeInTheDocument();
    expect(screen.getByText('í¬íŠ¸í´ë¦¬ì˜¤')).toBeInTheDocument();
    expect(screen.getByText('ê±°ë˜ ë‚´ì—­')).toBeInTheDocument();
  });

  test('ì‚¬ìš©ì ì •ë³´ê°€ í‘œì‹œëœë‹¤', async () => {
    renderWithProviders(<Dashboard />);
    
    await waitFor(() => {
      expect(screen.getByText('test@test.com')).toBeInTheDocument();
    });
  });

  test('ë©”ë‰´ í´ë¦­ ì‹œ í•´ë‹¹ ì„¹ì…˜ìœ¼ë¡œ ì´ë™í•œë‹¤', () => {
    renderWithProviders(<Dashboard />);
    
    const portfolioButton = screen.getByText('í¬íŠ¸í´ë¦¬ì˜¤');
    fireEvent.click(portfolioButton);
    
    expect(screen.getByTestId('portfolio-section')).toBeVisible();
  });
});
```

#### ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ í…ŒìŠ¤íŠ¸
```javascript
// web-dashboard/src/lib/__tests__/utils.test.js
import { formatCurrency, validateEmail, calculateProfit } from '../utils';

describe('ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜', () => {
  describe('formatCurrency', () => {
    test('ìˆ«ìë¥¼ ì˜¬ë°”ë¥¸ í†µí™” í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•œë‹¤', () => {
      expect(formatCurrency(1000000)).toBe('1,000,000ì›');
      expect(formatCurrency(0)).toBe('0ì›');
      expect(formatCurrency(-50000)).toBe('-50,000ì›');
    });

    test('ì˜ëª»ëœ ì…ë ¥ì— ëŒ€í•´ ê¸°ë³¸ê°’ì„ ë°˜í™˜í•œë‹¤', () => {
      expect(formatCurrency(null)).toBe('0ì›');
      expect(formatCurrency(undefined)).toBe('0ì›');
      expect(formatCurrency('invalid')).toBe('0ì›');
    });
  });

  describe('validateEmail', () => {
    test('ìœ íš¨í•œ ì´ë©”ì¼ì„ ê²€ì¦í•œë‹¤', () => {
      expect(validateEmail('test@example.com')).toBe(true);
      expect(validateEmail('user.name+tag@domain.co.kr')).toBe(true);
    });

    test('ìœ íš¨í•˜ì§€ ì•Šì€ ì´ë©”ì¼ì„ ê±°ë¶€í•œë‹¤', () => {
      expect(validateEmail('invalid-email')).toBe(false);
      expect(validateEmail('@domain.com')).toBe(false);
      expect(validateEmail('test@')).toBe(false);
    });
  });

  describe('calculateProfit', () => {
    test('ìˆ˜ìµë¥ ì„ ì •í™•íˆ ê³„ì‚°í•œë‹¤', () => {
      expect(calculateProfit(100000, 110000)).toEqual({
        profit: 10000,
        profitRate: 10
      });
      
      expect(calculateProfit(100000, 90000)).toEqual({
        profit: -10000,
        profitRate: -10
      });
    });
  });
});
```

### ğŸ”§ ë°±ì—”ë“œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸

#### API ë¼ìš°íŠ¸ í…ŒìŠ¤íŠ¸
```javascript
// backend/routes/__tests__/auth.test.js
const request = require('supertest');
const app = require('../../server');
const { supabase } = require('../../lib/supabase');

// Supabase ëª¨í‚¹
jest.mock('../../lib/supabase');

describe('ì¸ì¦ API', () => {
  beforeEach(() => {
    jest.clearAllMocks();
  });

  describe('POST /auth/login', () => {
    test('ìœ íš¨í•œ ìê²©ì¦ëª…ìœ¼ë¡œ ë¡œê·¸ì¸ ì„±ê³µ', async () => {
      const mockUser = {
        id: '123',
        email: 'test@test.com',
        access_token: 'mock-token'
      };

      supabase.auth.signInWithPassword.mockResolvedValue({
        data: { user: mockUser, session: { access_token: 'mock-token' } },
        error: null
      });

      const response = await request(app)
        .post('/auth/login')
        .send({
          email: 'test@test.com',
          password: 'password123'
        });

      expect(response.status).toBe(200);
      expect(response.body.success).toBe(true);
      expect(response.body.user.email).toBe('test@test.com');
    });

    test('ì˜ëª»ëœ ìê²©ì¦ëª…ìœ¼ë¡œ ë¡œê·¸ì¸ ì‹¤íŒ¨', async () => {
      supabase.auth.signInWithPassword.mockResolvedValue({
        data: { user: null, session: null },
        error: { message: 'Invalid credentials' }
      });

      const response = await request(app)
        .post('/auth/login')
        .send({
          email: 'test@test.com',
          password: 'wrongpassword'
        });

      expect(response.status).toBe(401);
      expect(response.body.success).toBe(false);
    });

    test('í•„ìˆ˜ í•„ë“œ ëˆ„ë½ ì‹œ 400 ì—ëŸ¬', async () => {
      const response = await request(app)
        .post('/auth/login')
        .send({
          email: 'test@test.com'
          // password ëˆ„ë½
        });

      expect(response.status).toBe(400);
      expect(response.body.error).toContain('í•„ìˆ˜');
    });
  });
});
```

#### ì„œë¹„ìŠ¤ ë¡œì§ í…ŒìŠ¤íŠ¸
```javascript
// backend/services/__tests__/kisService.test.js
const KisService = require('../kisService');
const axios = require('axios');

jest.mock('axios');

describe('KIS API ì„œë¹„ìŠ¤', () => {
  let kisService;

  beforeEach(() => {
    kisService = new KisService({
      appKey: 'test-app-key',
      appSecret: 'test-app-secret',
      mockMode: true
    });
    jest.clearAllMocks();
  });

  describe('getAccessToken', () => {
    test('ì•¡ì„¸ìŠ¤ í† í°ì„ ì„±ê³µì ìœ¼ë¡œ ê°€ì ¸ì˜¨ë‹¤', async () => {
      const mockResponse = {
        data: {
          access_token: 'mock-access-token',
          expires_in: 3600
        }
      };

      axios.post.mockResolvedValue(mockResponse);

      const token = await kisService.getAccessToken();

      expect(token).toBe('mock-access-token');
      expect(axios.post).toHaveBeenCalledWith(
        expect.stringContaining('/oauth2/tokenP'),
        expect.objectContaining({
          grant_type: 'client_credentials',
          appkey: 'test-app-key',
          appsecret: 'test-app-secret'
        })
      );
    });

    test('API ì˜¤ë¥˜ ì‹œ ì˜ˆì™¸ë¥¼ ë°œìƒì‹œí‚¨ë‹¤', async () => {
      axios.post.mockRejectedValue(new Error('Network error'));

      await expect(kisService.getAccessToken()).rejects.toThrow('Network error');
    });
  });

  describe('getCurrentPrice', () => {
    test('í˜„ì¬ê°€ë¥¼ ì„±ê³µì ìœ¼ë¡œ ì¡°íšŒí•œë‹¤', async () => {
      const mockResponse = {
        data: {
          output: {
            stck_prpr: '50000',
            prdy_vrss: '1000',
            prdy_vrss_sign: '2'
          }
        }
      };

      axios.get.mockResolvedValue(mockResponse);
      kisService.accessToken = 'mock-token';

      const price = await kisService.getCurrentPrice('005930');

      expect(price).toEqual({
        currentPrice: 50000,
        change: 1000,
        changeRate: expect.any(Number)
      });
    });
  });
});
```

## ğŸ”— í†µí•© í…ŒìŠ¤íŠ¸ (Integration Tests)

### ğŸŒ API í†µí•© í…ŒìŠ¤íŠ¸
```javascript
// backend/__tests__/integration/api.test.js
const request = require('supertest');
const app = require('../../server');
const { setupTestDB, cleanupTestDB } = require('../helpers/database');

describe('API í†µí•© í…ŒìŠ¤íŠ¸', () => {
  beforeAll(async () => {
    await setupTestDB();
  });

  afterAll(async () => {
    await cleanupTestDB();
  });

  describe('ì‚¬ìš©ì í”Œë¡œìš°', () => {
    let authToken;

    test('íšŒì›ê°€ì… â†’ ë¡œê·¸ì¸ â†’ í”„ë¡œí•„ ì¡°íšŒ í”Œë¡œìš°', async () => {
      // 1. íšŒì›ê°€ì…
      const signupResponse = await request(app)
        .post('/auth/signup')
        .send({
          email: 'integration@test.com',
          password: 'TestPassword123!',
          name: 'í…ŒìŠ¤íŠ¸ ì‚¬ìš©ì'
        });

      expect(signupResponse.status).toBe(201);

      // 2. ë¡œê·¸ì¸
      const loginResponse = await request(app)
        .post('/auth/login')
        .send({
          email: 'integration@test.com',
          password: 'TestPassword123!'
        });

      expect(loginResponse.status).toBe(200);
      authToken = loginResponse.body.token;

      // 3. í”„ë¡œí•„ ì¡°íšŒ
      const profileResponse = await request(app)
        .get('/api/profile')
        .set('Authorization', `Bearer ${authToken}`);

      expect(profileResponse.status).toBe(200);
      expect(profileResponse.body.email).toBe('integration@test.com');
    });
  });

  describe('KIS API ì—°ë™', () => {
    test('KIS API ì„¤ì • â†’ í† í° ë°œê¸‰ â†’ í˜„ì¬ê°€ ì¡°íšŒ', async () => {
      // ì‚¬ì „ ì¡°ê±´: ì¸ì¦ëœ ì‚¬ìš©ì
      const authResponse = await request(app)
        .post('/auth/login')
        .send({
          email: 'integration@test.com',
          password: 'TestPassword123!'
        });

      const authToken = authResponse.body.token;

      // 1. KIS API ì„¤ì •
      const settingsResponse = await request(app)
        .post('/api/kis/settings')
        .set('Authorization', `Bearer ${authToken}`)
        .send({
          appKey: process.env.KIS_DEMO_APP_KEY,
          appSecret: process.env.KIS_DEMO_APP_SECRET,
          mockMode: true
        });

      expect(settingsResponse.status).toBe(200);

      // 2. í† í° ë°œê¸‰ í…ŒìŠ¤íŠ¸
      const tokenResponse = await request(app)
        .post('/api/kis/token')
        .set('Authorization', `Bearer ${authToken}`);

      expect(tokenResponse.status).toBe(200);
      expect(tokenResponse.body.accessToken).toBeDefined();

      // 3. í˜„ì¬ê°€ ì¡°íšŒ
      const priceResponse = await request(app)
        .get('/api/kis/price/005930')
        .set('Authorization', `Bearer ${authToken}`);

      expect(priceResponse.status).toBe(200);
      expect(priceResponse.body.currentPrice).toBeDefined();
    });
  });
});
```

### ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ í†µí•© í…ŒìŠ¤íŠ¸
```javascript
// backend/__tests__/integration/database.test.js
const { supabase } = require('../../lib/supabase');

describe('ë°ì´í„°ë² ì´ìŠ¤ í†µí•© í…ŒìŠ¤íŠ¸', () => {
  describe('ì‚¬ìš©ì í”„ë¡œí•„ ê´€ë¦¬', () => {
    let testUserId;

    beforeEach(async () => {
      // í…ŒìŠ¤íŠ¸ ì‚¬ìš©ì ìƒì„±
      const { data: user } = await supabase.auth.signUp({
        email: `test-${Date.now()}@test.com`,
        password: 'TestPassword123!'
      });
      testUserId = user.user.id;
    });

    afterEach(async () => {
      // í…ŒìŠ¤íŠ¸ ë°ì´í„° ì •ë¦¬
      if (testUserId) {
        await supabase
          .from('user_profiles')
          .delete()
          .eq('id', testUserId);
      }
    });

    test('ì‚¬ìš©ì í”„ë¡œí•„ CRUD ì‘ì—…', async () => {
      // Create
      const { data: profile, error: createError } = await supabase
        .from('user_profiles')
        .insert({
          id: testUserId,
          email: 'test@test.com',
          role: 'user',
          subscription_type: 'free'
        })
        .select()
        .single();

      expect(createError).toBeNull();
      expect(profile.email).toBe('test@test.com');

      // Read
      const { data: readProfile, error: readError } = await supabase
        .from('user_profiles')
        .select('*')
        .eq('id', testUserId)
        .single();

      expect(readError).toBeNull();
      expect(readProfile.email).toBe('test@test.com');

      // Update
      const { data: updatedProfile, error: updateError } = await supabase
        .from('user_profiles')
        .update({ subscription_type: 'premium' })
        .eq('id', testUserId)
        .select()
        .single();

      expect(updateError).toBeNull();
      expect(updatedProfile.subscription_type).toBe('premium');

      // DeleteëŠ” afterEachì—ì„œ ìˆ˜í–‰
    });
  });
});
```

## ğŸŒ E2E í…ŒìŠ¤íŠ¸ (End-to-End Tests)

### ğŸ­ Playwright E2E í…ŒìŠ¤íŠ¸
```javascript
// tests/e2e/user-journey.spec.js
const { test, expect } = require('@playwright/test');

test.describe('ì‚¬ìš©ì ì—¬ì • í…ŒìŠ¤íŠ¸', () => {
  test.beforeEach(async ({ page }) => {
    await page.goto('http://localhost:3000');
  });

  test('íšŒì›ê°€ì…ë¶€í„° ê±°ë˜ê¹Œì§€ ì „ì²´ í”Œë¡œìš°', async ({ page }) => {
    // 1. íšŒì›ê°€ì…
    await page.click('text=íšŒì›ê°€ì…');
    await page.fill('[data-testid=email-input]', 'e2e@test.com');
    await page.fill('[data-testid=password-input]', 'TestPassword123!');
    await page.fill('[data-testid=name-input]', 'E2E í…ŒìŠ¤íŠ¸');
    await page.click('[data-testid=signup-button]');

    // íšŒì›ê°€ì… ì„±ê³µ í™•ì¸
    await expect(page.locator('text=íšŒì›ê°€ì…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤')).toBeVisible();

    // 2. ë¡œê·¸ì¸
    await page.fill('[data-testid=email-input]', 'e2e@test.com');
    await page.fill('[data-testid=password-input]', 'TestPassword123!');
    await page.click('[data-testid=login-button]');

    // ëŒ€ì‹œë³´ë“œ ë¡œë”© í™•ì¸
    await expect(page.locator('text=Christmas Trading')).toBeVisible();
    await expect(page.locator('[data-testid=dashboard]')).toBeVisible();

    // 3. KIS API ì„¤ì •
    await page.click('text=ì„¤ì •');
    await page.click('text=KIS API ì„¤ì •');
    
    await page.fill('[data-testid=kis-app-key]', 'DEMO-APP-KEY');
    await page.fill('[data-testid=kis-app-secret]', 'demo-app-secret');
    await page.click('[data-testid=save-kis-settings]');

    // ì„¤ì • ì €ì¥ í™•ì¸
    await expect(page.locator('text=ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤')).toBeVisible();

    // 4. í¬íŠ¸í´ë¦¬ì˜¤ í™•ì¸
    await page.click('text=í¬íŠ¸í´ë¦¬ì˜¤');
    await expect(page.locator('[data-testid=portfolio-section]')).toBeVisible();

    // 5. ê±°ë˜ ë‚´ì—­ í™•ì¸
    await page.click('text=ê±°ë˜ ë‚´ì—­');
    await expect(page.locator('[data-testid=trading-history]')).toBeVisible();
  });

  test('ê´€ë¦¬ì ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸', async ({ page }) => {
    // ê´€ë¦¬ì ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸
    await page.fill('[data-testid=email-input]', 'admin@christmas-trading.com');
    await page.fill('[data-testid=password-input]', 'AdminPassword123!');
    await page.click('[data-testid=login-button]');

    // ê´€ë¦¬ì íŒ¨ë„ ì ‘ê·¼
    await page.click('text=ê´€ë¦¬ì');
    await expect(page.locator('[data-testid=admin-panel]')).toBeVisible();

    // ì‚¬ìš©ì ê´€ë¦¬
    await page.click('text=ì‚¬ìš©ì ê´€ë¦¬');
    await expect(page.locator('[data-testid=user-list]')).toBeVisible();

    // ì‹œìŠ¤í…œ ì„¤ì •
    await page.click('text=ì‹œìŠ¤í…œ ì„¤ì •');
    await expect(page.locator('[data-testid=system-settings]')).toBeVisible();
  });

  test('ëª¨ë°”ì¼ ë°˜ì‘í˜• í…ŒìŠ¤íŠ¸', async ({ page }) => {
    // ëª¨ë°”ì¼ ë·°í¬íŠ¸ ì„¤ì •
    await page.setViewportSize({ width: 375, height: 667 });

    await page.goto('http://localhost:3000');

    // ëª¨ë°”ì¼ ë©”ë‰´ í™•ì¸
    await expect(page.locator('[data-testid=mobile-menu-button]')).toBeVisible();
    
    // ë©”ë‰´ ì—´ê¸°
    await page.click('[data-testid=mobile-menu-button]');
    await expect(page.locator('[data-testid=mobile-menu]')).toBeVisible();

    // ë„¤ë¹„ê²Œì´ì…˜ í…ŒìŠ¤íŠ¸
    await page.click('text=í¬íŠ¸í´ë¦¬ì˜¤');
    await expect(page.locator('[data-testid=portfolio-section]')).toBeVisible();
  });
});
```

### ğŸ”’ ë³´ì•ˆ í…ŒìŠ¤íŠ¸
```javascript
// tests/e2e/security.spec.js
const { test, expect } = require('@playwright/test');

test.describe('ë³´ì•ˆ í…ŒìŠ¤íŠ¸', () => {
  test('XSS ê³µê²© ë°©ì–´ í…ŒìŠ¤íŠ¸', async ({ page }) => {
    await page.goto('http://localhost:3000');
    
    // ë¡œê·¸ì¸
    await page.fill('[data-testid=email-input]', 'test@test.com');
    await page.fill('[data-testid=password-input]', 'TestPassword123!');
    await page.click('[data-testid=login-button]');

    // XSS ìŠ¤í¬ë¦½íŠ¸ ì…ë ¥ ì‹œë„
    const xssScript = '<script>alert("XSS")</script>';
    await page.fill('[data-testid=name-input]', xssScript);
    await page.click('[data-testid=save-profile]');

    // ìŠ¤í¬ë¦½íŠ¸ê°€ ì‹¤í–‰ë˜ì§€ ì•Šê³  í…ìŠ¤íŠ¸ë¡œ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸
    const nameDisplay = await page.locator('[data-testid=user-name]').textContent();
    expect(nameDisplay).not.toContain('<script>');
    expect(nameDisplay).toContain('&lt;script&gt;');
  });

  test('CSRF ê³µê²© ë°©ì–´ í…ŒìŠ¤íŠ¸', async ({ page }) => {
    // CSRF í† í° ì—†ì´ ìš”ì²­ ì‹œë„
    const response = await page.request.post('http://localhost:8000/api/profile', {
      data: { name: 'Hacked Name' }
    });

    expect(response.status()).toBe(403);
  });

  test('ê¶Œí•œ ì—†ëŠ” í˜ì´ì§€ ì ‘ê·¼ í…ŒìŠ¤íŠ¸', async ({ page }) => {
    // ë¡œê·¸ì¸í•˜ì§€ ì•Šê³  ê´€ë¦¬ì í˜ì´ì§€ ì ‘ê·¼ ì‹œë„
    await page.goto('http://localhost:3000/admin');
    
    // ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ë˜ëŠ”ì§€ í™•ì¸
    await expect(page.url()).toContain('/login');
  });
});
```

## ğŸš€ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸

### âš¡ ë¡œë“œ í…ŒìŠ¤íŠ¸
```javascript
// tests/performance/load-test.js
import http from 'k6/http';
import { check, sleep } from 'k6';

export let options = {
  stages: [
    { duration: '2m', target: 100 }, // 2ë¶„ ë™ì•ˆ 100ëª…ê¹Œì§€ ì¦ê°€
    { duration: '5m', target: 100 }, // 5ë¶„ ë™ì•ˆ 100ëª… ìœ ì§€
    { duration: '2m', target: 200 }, // 2ë¶„ ë™ì•ˆ 200ëª…ê¹Œì§€ ì¦ê°€
    { duration: '5m', target: 200 }, // 5ë¶„ ë™ì•ˆ 200ëª… ìœ ì§€
    { duration: '2m', target: 0 },   // 2ë¶„ ë™ì•ˆ 0ëª…ê¹Œì§€ ê°ì†Œ
  ],
  thresholds: {
    http_req_duration: ['p(99)<1500'], // 99%ì˜ ìš”ì²­ì´ 1.5ì´ˆ ì´ë‚´
    http_req_failed: ['rate<0.1'],     // ì—ëŸ¬ìœ¨ 10% ë¯¸ë§Œ
  },
};

export default function () {
  // í™ˆí˜ì´ì§€ ë¡œë“œ
  let response = http.get('http://localhost:3000');
  check(response, {
    'status is 200': (r) => r.status === 200,
    'page loads in <2s': (r) => r.timings.duration < 2000,
  });

  sleep(1);

  // API ì—”ë“œí¬ì¸íŠ¸ í…ŒìŠ¤íŠ¸
  response = http.get('http://localhost:8000/health');
  check(response, {
    'API status is 200': (r) => r.status === 200,
    'API responds in <500ms': (r) => r.timings.duration < 500,
  });

  sleep(1);
}
```

### ğŸ“Š Lighthouse ì„±ëŠ¥ í…ŒìŠ¤íŠ¸
```javascript
// tests/performance/lighthouse.js
const lighthouse = require('lighthouse');
const chromeLauncher = require('chrome-launcher');

async function runLighthouse() {
  const chrome = await chromeLauncher.launch({ chromeFlags: ['--headless'] });
  
  const options = {
    logLevel: 'info',
    output: 'html',
    onlyCategories: ['performance', 'accessibility', 'best-practices', 'seo'],
    port: chrome.port,
  };

  const runnerResult = await lighthouse('http://localhost:3000', options);

  // ì„±ëŠ¥ ì ìˆ˜ í™•ì¸
  const scores = runnerResult.lhr.categories;
  
  console.log('Lighthouse ì ìˆ˜:');
  console.log(`ì„±ëŠ¥: ${Math.round(scores.performance.score * 100)}`);
  console.log(`ì ‘ê·¼ì„±: ${Math.round(scores.accessibility.score * 100)}`);
  console.log(`ëª¨ë²” ì‚¬ë¡€: ${Math.round(scores['best-practices'].score * 100)}`);
  console.log(`SEO: ${Math.round(scores.seo.score * 100)}`);

  // ì„±ëŠ¥ ê¸°ì¤€ ê²€ì¦
  if (scores.performance.score < 0.9) {
    throw new Error(`ì„±ëŠ¥ ì ìˆ˜ê°€ ê¸°ì¤€(90) ë¯¸ë‹¬: ${Math.round(scores.performance.score * 100)}`);
  }

  await chrome.kill();
}

runLighthouse().catch(console.error);
```

## ğŸ”„ CI/CD í…ŒìŠ¤íŠ¸ ìë™í™”

### ğŸ¤– GitHub Actions ì›Œí¬í”Œë¡œìš°
```yaml
# .github/workflows/test.yml
name: í…ŒìŠ¤íŠ¸ ìë™í™”

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

jobs:
  unit-tests:
    runs-on: ubuntu-latest
    
    strategy:
      matrix:
        node-version: [18.x, 20.x]
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Node.js ì„¤ì •
      uses: actions/setup-node@v3
      with:
        node-version: ${{ matrix.node-version }}
        cache: 'npm'
    
    - name: ì˜ì¡´ì„± ì„¤ì¹˜
      run: |
        npm ci
        cd backend && npm ci
        cd ../web-dashboard && npm ci
    
    - name: ë°±ì—”ë“œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
      run: |
        cd backend
        npm test -- --coverage
    
    - name: í”„ë¡ íŠ¸ì—”ë“œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
      run: |
        cd web-dashboard
        npm test -- --coverage --watchAll=false
    
    - name: ì½”ë“œ ì»¤ë²„ë¦¬ì§€ ì—…ë¡œë“œ
      uses: codecov/codecov-action@v3
      with:
        files: ./backend/coverage/lcov.info,./web-dashboard/coverage/lcov.info

  integration-tests:
    runs-on: ubuntu-latest
    needs: unit-tests
    
    services:
      postgres:
        image: postgres:13
        env:
          POSTGRES_PASSWORD: postgres
        options: >-
          --health-cmd pg_isready
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Node.js ì„¤ì •
      uses: actions/setup-node@v3
      with:
        node-version: 18.x
    
    - name: ì˜ì¡´ì„± ì„¤ì¹˜
      run: |
        npm ci
        cd backend && npm ci
    
    - name: ë°±ì—”ë“œ ì„œë²„ ì‹œì‘
      run: |
        cd backend
        npm start &
        sleep 10
      env:
        NODE_ENV: test
        SUPABASE_URL: ${{ secrets.SUPABASE_URL }}
        SUPABASE_ANON_KEY: ${{ secrets.SUPABASE_ANON_KEY }}
    
    - name: í†µí•© í…ŒìŠ¤íŠ¸ ì‹¤í–‰
      run: |
        cd backend
        npm run test:integration

  e2e-tests:
    runs-on: ubuntu-latest
    needs: integration-tests
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Node.js ì„¤ì •
      uses: actions/setup-node@v3
      with:
        node-version: 18.x
    
    - name: ì˜ì¡´ì„± ì„¤ì¹˜
      run: |
        npm ci
        cd backend && npm ci
        cd ../web-dashboard && npm ci
        npx playwright install
    
    - name: ì„œë²„ ì‹œì‘
      run: |
        cd backend && npm start &
        cd web-dashboard && npm run dev &
        sleep 30
    
    - name: E2E í…ŒìŠ¤íŠ¸ ì‹¤í–‰
      run: npx playwright test
    
    - name: í…ŒìŠ¤íŠ¸ ê²°ê³¼ ì—…ë¡œë“œ
      uses: actions/upload-artifact@v3
      if: failure()
      with:
        name: playwright-report
        path: playwright-report/

  security-tests:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v3
    
    - name: ë³´ì•ˆ ì·¨ì•½ì  ìŠ¤ìº”
      run: |
        cd backend && npm audit --audit-level moderate
        cd ../web-dashboard && npm audit --audit-level moderate
    
    - name: Snyk ë³´ì•ˆ í…ŒìŠ¤íŠ¸
      uses: snyk/actions/node@master
      env:
        SNYK_TOKEN: ${{ secrets.SNYK_TOKEN }}
```

## ğŸ“Š í…ŒìŠ¤íŠ¸ ë¦¬í¬íŒ… ë° ëª¨ë‹ˆí„°ë§

### ğŸ“ˆ í…ŒìŠ¤íŠ¸ ë©”íŠ¸ë¦­ ìˆ˜ì§‘
```javascript
// scripts/test-metrics.js
const fs = require('fs');
const path = require('path');

class TestMetrics {
  constructor() {
    this.metrics = {
      timestamp: new Date().toISOString(),
      unitTests: {},
      integrationTests: {},
      e2eTests: {},
      coverage: {}
    };
  }

  collectUnitTestMetrics(testResults) {
    this.metrics.unitTests = {
      total: testResults.numTotalTests,
      passed: testResults.numPassedTests,
      failed: testResults.numFailedTests,
      duration: testResults.testResults.reduce((sum, result) => 
        sum + result.perfStats.end - result.perfStats.start, 0
      )
    };
  }

  collectCoverageMetrics(coverageData) {
    this.metrics.coverage = {
      lines: coverageData.total.lines.pct,
      functions: coverageData.total.functions.pct,
      branches: coverageData.total.branches.pct,
      statements: coverageData.total.statements.pct
    };
  }

  generateReport() {
    const reportPath = path.join(__dirname, '../reports/test-metrics.json');
    fs.writeFileSync(reportPath, JSON.stringify(this.metrics, null, 2));
    
    console.log('ğŸ“Š í…ŒìŠ¤íŠ¸ ë©”íŠ¸ë¦­ ë¦¬í¬íŠ¸ ìƒì„± ì™„ë£Œ');
    console.log(`íŒŒì¼ ìœ„ì¹˜: ${reportPath}`);
  }

  sendToMonitoring() {
    // ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œìœ¼ë¡œ ë©”íŠ¸ë¦­ ì „ì†¡
    // (ì˜ˆ: Datadog, New Relic, ìì²´ ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ)
  }
}

module.exports = TestMetrics;
```

## ğŸ“š ê´€ë ¨ ë¬¸ì„œ ë§í¬
- [í”„ë¡œì íŠ¸ ê´€ë¦¬ ê°€ì´ë“œ](./46.%20í”„ë¡œì íŠ¸%20ê´€ë¦¬%20ë°%20ì„œë²„%20ì´ì „%20ê°€ì´ë“œ.md)
- [í”„ë¡œì íŠ¸ êµ¬ì¡°ë„](./47.%20í”„ë¡œì íŠ¸%20êµ¬ì¡°ë„.md)
- [ì˜ì¡´ì„± ê´€ë¦¬ ë¬¸ì„œ](./48.%20ì˜ì¡´ì„±%20ê´€ë¦¬%20ë¬¸ì„œ.md)
- [ë³´ì•ˆ ê°€ì´ë“œë¼ì¸](./49.%20ë³´ì•ˆ%20ê°€ì´ë“œë¼ì¸.md)

## ğŸ“ ì—…ë°ì´íŠ¸ ì´ë ¥
- 2024-12-25: ì´ˆê¸° ë¬¸ì„œ ìƒì„±
- í–¥í›„ ì—…ë°ì´íŠ¸ ì˜ˆì •

---
**âš ï¸ ì¤‘ìš”**: í…ŒìŠ¤íŠ¸ëŠ” ê°œë°œ í”„ë¡œì„¸ìŠ¤ì˜ í•µì‹¬ì…ë‹ˆë‹¤. ëª¨ë“  ìƒˆë¡œìš´ ê¸°ëŠ¥ì€ ì ì ˆí•œ í…ŒìŠ¤íŠ¸ì™€ í•¨ê»˜ ê°œë°œë˜ì–´ì•¼ í•˜ë©°, ê¸°ì¡´ í…ŒìŠ¤íŠ¸ê°€ ì‹¤íŒ¨í•˜ëŠ” ê²½ìš° ë°˜ë“œì‹œ ìˆ˜ì •í•´ì•¼ í•©ë‹ˆë‹¤. 