# ğŸ” Christmas Trading - í˜„ì¬ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ë¶„ì„

## ğŸ“Š **ë¶„ì„ ê²°ê³¼ ìš”ì•½**

### **ì‹¤ì œ ìƒí™©**
- **í…Œì´ë¸”**: `users` (ì‹¤ì œ ì¡´ì¬, ë¹ˆ ìƒíƒœ, RLS í™œì„±í™”)
- **ìŠ¤í‚¤ë§ˆ íŒŒì¼**: `profiles` í…Œì´ë¸” ì •ì˜ (ì‹¤ì œ ì‚¬ìš©ë˜ì§€ ì•ŠìŒ)
- **ì½”ë“œ**: `users` í…Œì´ë¸” ì°¸ì¡°í•˜ì§€ë§Œ ì»¬ëŸ¼ëª… ë¶ˆì¼ì¹˜

### **ì»¬ëŸ¼ëª… ë§¤í•‘ í•„ìš”**

| í˜„ì¬ ì½”ë“œ | ìŠ¤í‚¤ë§ˆ íŒŒì¼ | ê¶Œì¥ í†µì¼ëª… |
|----------|------------|------------|
| `membership_type` | `subscription_tier` | `subscription_tier` |
| `binance_api_key` | `binance_api_key_encrypted` | `binance_api_key` |
| `binance_secret_key` | `binance_secret_key_encrypted` | `binance_secret_key` |

## ğŸ”§ **ìˆ˜ì • ì™„ë£Œ ì‚¬í•­**

### âœ… **AuthContext.tsx**
- `UserProfile` ì¸í„°í˜ì´ìŠ¤ì— `subscription_tier` ì¶”ê°€
- `mapMembershipToSubscriptionTier()` í•¨ìˆ˜ ì¶”ê°€
- í”„ë¡œí•„ ì¡°íšŒ ì‹œ ìë™ ë§¤í•‘ êµ¬í˜„

### âœ… **íƒ€ì… ì •ì˜ í†µì¼**
- `membership_type` â†’ `subscription_tier` ë§¤í•‘
- ì¶”ê°€ í•„ë“œë“¤ (`display_name`, `portfolio_balance_usdt`, `available_cash_usdt`) ì§€ì›

## ğŸ”„ **ì§„í–‰ ì¤‘ ì‘ì—…**

### ğŸ”§ **apiKeyService.ts ìˆ˜ì • í•„ìš”**
í˜„ì¬ ìƒíƒœ:
```javascript
binance_api_key: encryptedApiKey,
binance_secret_key: encryptedSecretKey,
```

### ğŸ“ **ê¸°íƒ€ ì»´í¬ë„ŒíŠ¸ ìˆ˜ì • í•„ìš”**
- `AuthButton.tsx`: `profile.subscription_tier` ì‚¬ìš© (ë§¤í•‘ìœ¼ë¡œ í•´ê²°)
- ê¸°íƒ€ `subscription_tier` ì°¸ì¡° ì»´í¬ë„ŒíŠ¸ë“¤

## ğŸ’¡ **ê¶Œì¥ ì‚¬í•­**

1. **í˜„ì¬ ì ‘ê·¼ ë°©ì‹ ìœ ì§€**: `users` í…Œì´ë¸” ê³„ì† ì‚¬ìš©
2. **ì»¬ëŸ¼ëª… í†µì¼**: ëª¨ë“  ì½”ë“œì—ì„œ `subscription_tier` ì‚¬ìš©
3. **ë§¤í•‘ ë¡œì§**: AuthContextì—ì„œ ìë™ ë³€í™˜ ì²˜ë¦¬
4. **API í‚¤ ì»¬ëŸ¼**: í˜„ì¬ ì‚¬ìš© ì¤‘ì¸ `binance_api_key`, `binance_secret_key` ìœ ì§€

## âœ¨ **ìˆ˜ì • ì™„ë£Œ ì‚¬í•­**

âœ… **ëª¨ë“  ì‘ì—… ì™„ë£Œë¨**

### **1. AuthContext.tsx**
- `UserProfile` ì¸í„°í˜ì´ìŠ¤ì— `subscription_tier` í•„ë“œ ì¶”ê°€
- `mapMembershipToSubscriptionTier()` ë§¤í•‘ í•¨ìˆ˜ êµ¬í˜„
- í”„ë¡œí•„ ì¡°íšŒ ì‹œ ìë™ ë§¤í•‘ ë° ê¸°ë³¸ê°’ ì„¤ì •

### **2. AuthButton.tsx**
- ì˜µì…”ë„ ì²´ì´ë‹ìœ¼ë¡œ íƒ€ì… ì•ˆì „ì„± ê°œì„ 
- `portfolio_balance_usdt`, `available_cash_usdt` ê¸°ë³¸ê°’ ì²˜ë¦¬

### **3. apiKeyService.ts**
- ê¸°ì¡´ ì»¬ëŸ¼ëª… (`binance_api_key`, `binance_secret_key`) ìœ ì§€
- ì£¼ì„ìœ¼ë¡œ ëŒ€ì•ˆ ì»¬ëŸ¼ëª… í‘œì‹œ

### **4. supabase_schema.sql**
- `profiles` â†’ `users` í…Œì´ë¸” êµ¬ì¡°ë¡œ í†µì¼
- ëª¨ë“  ì™¸ë˜í‚¤ ì°¸ì¡°ë¥¼ `users` í…Œì´ë¸”ë¡œ ìˆ˜ì •
- RLS ì •ì±… ë° íŠ¸ë¦¬ê±° ì—…ë°ì´íŠ¸
- ì‹¤ì œ ì‚¬ìš©ë˜ëŠ” ì»¬ëŸ¼ëª…ìœ¼ë¡œ í†µì¼

## ğŸ’¡ **í•´ê²°ëœ ë¬¸ì œì **

1. **í…Œì´ë¸”ëª… ë¶ˆì¼ì¹˜**: `profiles` vs `users` â†’ `users`ë¡œ í†µì¼
2. **ì»¬ëŸ¼ëª… ë¶ˆì¼ì¹˜**: `membership_type` vs `subscription_tier` â†’ ë§¤í•‘ìœ¼ë¡œ í•´ê²°
3. **API í‚¤ ì»¬ëŸ¼**: ì‹¤ì œ ì‚¬ìš© ì¤‘ì¸ ì´ë¦„ ìœ ì§€
4. **íƒ€ì… ì•ˆì „ì„±**: ì˜µì…”ë„ ì²´ì´ë‹ ë° ê¸°ë³¸ê°’ ì¶”ê°€

## ğŸ¯ **ìµœì¢… ê²°ê³¼**

- **ê¸°ì¡´ ì½”ë“œ ìµœì†Œ ë³€ê²½**ìœ¼ë¡œ ë¬¸ì œ í•´ê²°
- **ì¼ê´€ëœ ì»¬ëŸ¼ëª…** ì‚¬ìš© (`subscription_tier`)
- **íƒ€ì… ì•ˆì „ì„±** í–¥ìƒ
- **í•˜ìœ„ í˜¸í™˜ì„±** ìœ ì§€
- **ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ** ì‹¤ì œ ì‚¬ìš© êµ¬ì¡° ë°˜ì˜

---

**ìµœì¢… ì—…ë°ì´íŠ¸**: 2025-06-29 UTC  
**ìƒíƒœ**: âœ… **ëª¨ë“  ì‘ì—… ì™„ë£Œ** - í”„ë¡œë•ì…˜ ì¤€ë¹„ ì™„ë£Œ